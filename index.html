<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart-Trade EA - Mentor Portal</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Auth Section -->
  <div id="authContainer">
    <div id="authBox" class="auth-box">
      <div id="authTabs">
        <button id="loginTab" class="active" onclick="showAuthTab('login')">Login</button>
        <button id="signupTab" onclick="showAuthTab('signup')">Sign Up</button>
      </div>
      <form id="loginForm" class="auth-form" onsubmit="return login(event)">
        <h2>Login</h2>
        <input type="email" id="loginEmail" placeholder="Email" required>
        <input type="password" id="loginPassword" placeholder="Password" required>
        <button class="btn" type="submit">Login</button>
      </form>
      <form id="signupForm" class="auth-form" style="display:none" onsubmit="return signup(event)">
        <h2>Sign Up</h2>
        <input type="text" id="signupName" placeholder="Full Name" required>
        <input type="email" id="signupEmail" placeholder="Email" required>
        <input type="password" id="signupPassword" placeholder="Password" required>
        <button class="btn" type="submit">Sign Up</button>
      </form>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashboardContainer" style="display:none;">
    <div class="top-bar">
      <div class="menu-toggle" onclick="toggleSidebar()">&#9776;</div>
      <div class="profile-icon" id="profileIcon" onclick="toggleProfile()"></div>
      <div class="profile-dropdown" id="profileDropdown"></div>
    </div>
    <div class="sidebar" id="sidebar">
      <a href="#" onclick="showSection('dashboardSection')">Dashboard</a>
      <a href="#" onclick="showSection('eaListSection')">My EAs</a>
      <a href="#" onclick="showSection('createEA')">Create EA</a>
      <a href="#" onclick="showSection('userListSection')">Users</a>
      <a href="#" onclick="showSection('createKey')">Generate Key</a>
      <a href="#" onclick="showSection('purchaseKeys')">Purchase Keys</a>
      <a href="#" onclick="showSection('keyStats')">Key Stats</a>
      <a href="#" onclick="showSection('exportSection')">Export/Backup</a>
      <a href="#" onclick="showSection('logsSection')">Logs</a>
      <a href="#" onclick="showSection('helpSection')">Help/Support</a>
    </div>

    <div class="main-grid">

      <!-- Dashboard Overview -->
      <div id="dashboardSection" class="dashboard-block">
        <h2 id="dashboardWelcome"></h2>
        <div id="dateTime"></div>
        <div class="dashboard-stats">
          <div class="stat-card">
            <span id="statEAs">0</span>
            <div>EAs</div>
          </div>
          <div class="stat-card">
            <span id="statKeys">0</span>
            <div>Keys</div>
          </div>
          <div class="stat-card">
            <span id="statUsers">0</span>
            <div>Users</div>
          </div>
          <div class="stat-card">
            <span id="statActiveKeys">0</span>
            <div>Active Keys</div>
          </div>
        </div>
        <div id="recentActions" class="recent-actions"></div>
      </div>

      <!-- EA List/Manage -->
      <div id="eaListSection" class="form-section" style="display:none">
        <div class="section-header">
          <h3>My EAs</h3>
          <button class="btn" onclick="showSection('createEA')">+ New EA</button>
        </div>
        <div id="eaList"></div>
      </div>

      <!-- Create or Edit EA -->
      <div id="createEA" class="form-section" style="display:none">
        <h3 id="eaFormTitle">Create New EA</h3>
        <label>EA Name</label>
        <input type="text" id="eaName" />
        <label>EA Logo (display only in app)</label>
        <input type="file" id="eaLogo" accept="image/*" />
        <input type="hidden" id="eaEditId" />
        <div class="form-btn-group">
          <button class="btn" onclick="generateEA()">Save & Download MT5 Hosting (.mq5)</button>
          <button class="btn btn-secondary" onclick="cancelEAEdit()" type="button">Cancel</button>
        </div>
      </div>

      <!-- Users List -->
      <div id="userListSection" class="form-section" style="display:none">
        <h3>EA Users</h3>
        <div id="userList"></div>
      </div>

      <!-- Generate Key -->
      <div id="createKey" class="form-section" style="display:none">
        <h3>Create License Key</h3>
        <label>User Name</label>
        <input type="text" id="userName" placeholder="User full name" />

        <label>User Email</label>
        <input type="email" id="userEmail" placeholder="user@example.com" />

        <label>Expiry</label>
        <select id="keyExpiry">
          <option value="3d">3 Days</option>
          <option value="1m">1 Month</option>
          <option value="2m">2 Months</option>
          <option value="6m">6 Months</option>
          <option value="1y">1 Year</option>
        </select>
        <button class="btn" onclick="generateKey()">Generate Key</button>
        <p id="generatedKey"></p>
      </div>

      <!-- Purchase More Keys -->
      <div id="purchaseKeys" class="form-section" style="display:none">
        <h3>Purchase Additional Keys</h3>
        <p>Contact <strong>pmtservices123@gmail.com</strong> to buy more keys.</p>
      </div>

      <!-- Key Stats -->
      <div id="keyStats" class="form-section" style="display:none">
        <h3>Key Stats & Management</h3>
        <div class="key-controls">
          <input type="text" id="keySearch" placeholder="Search keys/users..." oninput="renderKeyStats()" />
          <select id="keyStatusFilter" onchange="renderKeyStats()">
            <option value="">All</option>
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
            <option value="Expired">Expired</option>
          </select>
        </div>
        <table id="keyStatsTable">
          <thead>
            <tr>
              <th>License Key</th>
              <th>User Name</th>
              <th>User Email</th>
              <th>Created At</th>
              <th>Expiry</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Export/Backup -->
      <div id="exportSection" class="form-section" style="display:none">
        <h3>Export & Backup</h3>
        <button class="btn" onclick="exportKeys()">Export Keys (.csv)</button>
        <button class="btn" onclick="exportEAs()">Export EAs (.csv)</button>
        <button class="btn" onclick="backupData()">Backup Data (JSON)</button>
        <input type="file" id="importBackupFile" accept=".json" style="margin-top:10px;" onchange="importBackup(event)" />
        <label for="importBackupFile" class="btn btn-secondary">Restore from Backup</label>
        <div id="exportStatus"></div>
      </div>

      <!-- Logs -->
      <div id="logsSection" class="form-section" style="display:none">
        <h3>Action Logs</h3>
        <div id="logsList"></div>
      </div>

      <!-- Help/Support -->
      <div id="helpSection" class="form-section" style="display:none">
        <h3>Help & Support</h3>
        <p>
          <strong>How to use:</strong><br>
          - Use the sidebar to navigate.<br>
          - Create EAs and generate keys for your users.<br>
          - Manage, export, and backup your data.<br>
        </p>
        <p>
          <strong>Contact Support:</strong><br>
          Email: <a href="mailto:pmtservices123@gmail.com">pmtservices123@gmail.com</a>
        </p>
        <p>
          <strong>FAQ:</strong>
          <ul>
            <li>How do I deactivate a key? — Go to Key Stats and use the action button.</li>
            <li>How do I export my data? — Go to Export/Backup section.</li>
            <li>How do I change my password? — Click your profile icon.</li>
          </ul>
        </p>
      </div>
    </div>

    <!-- Floating Button for Quick Key Generation -->
    <button class="floating-btn" onclick="showSection('createKey')" title="Generate New Key">+</button>
  </div>
  <script src="main.js"></script>
</body>
</html>