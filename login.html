<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PMT Trading Login</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111827; color: #f9fafb; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
    .container { background: #1f2937; padding: 30px; border-radius: 12px; box-shadow: 0 0 20px rgba(0,0,0,0.3); max-width: 400px; width: 100%; }
    h2 { text-align: center; color: #22c55e; }
    label { display: block; margin: 15px 0 5px; }
    input { width: 100%; padding: 10px; border: none; border-radius: 6px; margin-bottom: 10px; font-size: 1em;}
    button { width: 100%; padding: 12px; border: none; background: #2563eb; color: #fff; font-size: 16px; border-radius: 8px; cursor: pointer; font-weight: bold;}
    .success, .error { margin-top: 15px; text-align: center; font-weight: bold;}
    .success { color: #34d399; }
    .error { color: #f87171; }
    .logout { margin: 16px auto 0 auto; display:block; background:#e84118; }
  </style>
</head>
<body>
  <div class="container">
    <h2>PMT Member Login</h2>
    <label for="email">Email Address</label>
    <input type="email" id="email" placeholder="example@gmail.com" required autocomplete="email"/>
    <label for="memberId">Member ID</label>
    <input type="text" id="memberId" placeholder="Enter your PMT Member ID" required autocomplete="username"/>
    <button onclick="login()">Login / Signup</button>
    <button class="logout" onclick="logout()" style="display:none" id="logoutBtn">Logout</button>
    <div id="statusMsg"></div>
  </div>
  <script>
    // If already logged in, show logout
    if(localStorage.getItem("pmt_email") && localStorage.getItem("pmt_member_id")) {
      document.getElementById("logoutBtn").style.display = "";
      document.getElementById("email").value = localStorage.getItem("pmt_email");
      document.getElementById("memberId").value = localStorage.getItem("pmt_member_id");
      document.getElementById("statusMsg").innerHTML = '<span class="success">✅ Already logged in.<br>Member ID: <b>' + localStorage.getItem("pmt_member_id") + '</b></span>';
    }
    function validEmail(email) {
      return /^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/.test(email);
    }
    function validMemberId(id) {
      // Example: PMT-6digits, or at least 6 chars
      return /^PMT-\d{6,}$/.test(id) || id.length >= 6;
    }
    function login() {
      const email = document.getElementById("email").value.trim();
      const memberId = document.getElementById("memberId").value.trim();
      const status = document.getElementById("statusMsg");
      if (!email || !memberId) {
        status.innerHTML = '<span class="error">Both fields are required.</span>';
        return;
      }
      if (!validEmail(email)) {
        status.innerHTML = '<span class="error">Enter a valid email address.</span>';
        return;
      }
      if (!validMemberId(memberId)) {
        status.innerHTML = '<span class="error">Member ID must start with "PMT-" and at least 6 digits, or be at least 6 characters.</span>';
        return;
      }
      localStorage.setItem("pmt_email", email);
      localStorage.setItem("pmt_member_id", memberId);
      status.innerHTML = '<span class="success">✅ Logged in successfully!<br>Welcome, ' + email + '</span>';
      document.getElementById("logoutBtn").style.display = "";
      setTimeout(() => { window.location.href = "app.html"; }, 1100);
    }
    function logout() {
      localStorage.removeItem("pmt_email");
      localStorage.removeItem("pmt_member_id");
      document.getElementById("statusMsg").innerHTML = '<span class="success">You have been logged out.</span>';
      setTimeout(()=>{window.location.reload();},900);
    }
  </script>
</body>
</html>